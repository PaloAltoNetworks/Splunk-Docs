
<!DOCTYPE HTML>
<html lang="">
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>User-ID with Splunk &#xB7; GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-image-captions/image-captions.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-bootstrap-callout/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-collapsible-chapters/collapsible-chapters.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

        
    
    
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="commands.html">
    
    
    <link rel="prev" href="external-search.html">
    

    </head>
    <body>
        
<div class="book"><nav class="navbar navbar-default hidden-xs hidden-sm">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand" href=".">
                Palo Alto Networks App for Splunk
            </a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-menu">
            <ul class="nav navbar-nav navbar-left" style="margin-left: 30px;">
                <li><a href="https://splunkbase.splunk.com/app/491">Download App</a></li>
                <li><a href="https://splunkbase.splunk.com/app/2757/">Download Add-on</a></li>
                <li><a href="/faq.html">FAQ</a></li>
                <li><a href="https://www.paloaltonetworks.com/partners/strategic-partners/splunk">Splunk Partnership</a></li>
            </ul>
        </div>
    </div>
</nav>
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search">
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">Overview</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="webinars-and-videos.html">
            
                <a href="webinars-and-videos.html">
            
                    
                    Webinars and Videos
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="faq.html">
            
                <a href="faq.html">
            
                    
                    Frequently Asked Questions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="troubleshoot.html">
            
                <a href="troubleshoot.html">
            
                    
                    Troubleshooting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="support.html">
            
                <a href="support.html">
            
                    
                    Get Support
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="release-notes.html">
            
                <a href="release-notes.html">
            
                    
                    Release Notes
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Getting Started</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="compatibility.html">
            
                <a href="compatibility.html">
            
                    
                    Compatibility
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="installation.html">
            
                <a href="installation.html">
            
                    
                    Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="getting-data-in.html">
            
                <a href="getting-data-in.html">
            
                    
                    Getting Data Into Splunk
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.3.1" data-path="firewalls-panorama-and-traps.html">
            
                <a href="firewalls-panorama-and-traps.html">
            
                    
                    Firewalls, Panorama, and Traps
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.2" data-path="cortex-hec.html">
            
                <a href="cortex-hec.html">
            
                    
                    Cortex Data Lake
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.3" data-path="aperture.html">
            
                <a href="aperture.html">
            
                    
                    Aperture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.4" data-path="autofocus-and-minemeld.html">
            
                <a href="autofocus-and-minemeld.html">
            
                    
                    AutoFocus and MineMeld
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.5" data-path="iot-security.html">
            
                <a href="iot-security.html">
            
                    
                    IoT Security
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.6" data-path="wildfire.html">
            
                <a href="wildfire.html">
            
                    
                    WildFire
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.7" data-path="universal-forwarder.html">
            
                <a href="universal-forwarder.html">
            
                    
                    Syslog-ng and Universal Forwarder
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="log-correlation.html">
            
                <a href="log-correlation.html">
            
                    
                    Log Correlation
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Configuration</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="upgrade.html">
            
                <a href="upgrade.html">
            
                    
                    Upgrade the App/Add-on
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="tune-or-reduce-firewall-logs.html">
            
                <a href="tune-or-reduce-firewall-logs.html">
            
                    
                    Tune or Reduce Firewall Logs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="enterprise-security.html">
            
                <a href="enterprise-security.html">
            
                    
                    Splunk Enterprise Security
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="lookups.html">
            
                <a href="lookups.html">
            
                    
                    Add Context to Searches
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Advanced Features</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="adaptive-response.html">
            
                <a href="adaptive-response.html">
            
                    
                    Adaptive Response
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="threat-intelligence.html">
            
                <a href="threat-intelligence.html">
            
                    
                    Threat Intelligence
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="external-search.html">
            
                <a href="external-search.html">
            
                    
                    External Search
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="4.4" data-path="userid.html">
            
                <a href="userid.html">
            
                    
                    User-ID with Splunk
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="commands.html">
            
                <a href="commands.html">
            
                    
                    Searchbar Command Reference
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="dashboards.html">
            
                <a href="dashboards.html">
            
                    
                    Dashboard Reference
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".">User-ID with Splunk</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="user-id-with-splunk">User-ID with Splunk</h1>
<p>The Palo Alto Networks firewall will inform Splunk of the user generating each connection or event via the syslogs it sends to Splunk. This assumes that the firewall is getting the login information from AD or some other authentication system, to know what user is logged into the device generating the traffic.</p>
<p>Often a system like a RADIUS server sends authentication logs to Splunk to be indexed. When these logs arrive at Splunk, Splunk can synchronize with the firewall the knowledge of where users logged in. This keeps the firewall&apos;s User-ID up to date for policy enforcement and monitoring. There are two ways to synchronize user-id information to the firewall, depending on how your authentication logs are formatted in Splunk.</p>
<h2 id="sync-user-login-events-with-user-id">Sync user login events with User-ID</h2>
<p>The Palo Alto Networks firewall will inform Splunk of the user generating each connection or event via the syslogs it sends to Splunk. This assumes that the firewall is getting the login information from AD or some other authentication system, to know what user is logged into the device generating the traffic.</p>
<p>If authentication logs are being indexed by Splunk, then Splunk can synchronize knowledge of where users are logged in with the firewall. For example, if Splunk is receiving a radius authentication log where &apos;user&apos; is the field containing the user who authenticated, and &apos;ip&apos; is the field containing the IP address where the user logged in, then you can map the user to the ip on the firewall.</p>
<p>In this situation, it is often preferred to use Splunk syslog forwarding to a User-ID agent or firewall because it is more efficient. But there are some cases where the user and IP are not in the same log. For example, if an authentication log contains the user and MAC address, and the DHCP log contains the MAC address and IP. A correlation must be done on the MAC address to know which IP the user logged in from. In this situation, the panuserupdate command is the preferred solution.</p>
<p>See also:  </p>
<ul>
<li>Searchbar Command: <a href="commands.html#panuserupdate">panuserupdate</a></li>
</ul>
<h2 id="method-1-splunk-forwarding">Method 1: Splunk Forwarding</h2>
<p>This is the <strong>recommended</strong> method.</p>
<p>When Splunk receives authentication logs from an external system (like a RADIUS server), forward the authentication logs from Splunk to a User-ID Agent or User-ID Firewall. The logs must contain both the user and the IP address where they logged in/out.</p>
<p>This method is recommended because it is more efficient.</p>
<p><strong>Step 1: Configure log forwarding on Splunk</strong> <a href="http://docs.splunk.com/Documentation/Splunk/6.3.0/Forwarding/Forwarddatatothird-partysystemsd" target="_blank">http://docs.splunk.com/Documentation/Splunk/6.3.0/Forwarding/Forwarddatatothird-partysystemsd</a></p>
<p><strong>Step 2: Configure syslog receiving on User-ID firewall/agent</strong> <a href="https://www.paloaltonetworks.com/documentation/70/pan-os/pan-os/user-id/configure-user-id-to-receive-user-mappings-from-a-syslog-sender.html" target="_blank">https://www.paloaltonetworks.com/documentation/70/pan-os/pan-os/user-id/configure-user-id-to-receive-user-mappings-from-a-syslog-sender.html</a></p>
<h2 id="method-2-searchbar-command">Method 2: Searchbar Command</h2>
<p>Use the <code>panuserupdate</code> command that is included with the app.</p>
<p>For this method, the logs are not required to contain both the user and ip in the same log. For example, where there is an authentication log with user and MAC address, and a DHCP log with MAC address and IP address. Splunk can do a search correlating the user to the IP using the MAC as the common value, then pass the search results to the <code>panuserupdate</code> command which will update the mapping on the firewall.</p>
<p>See <a href="commands.html#panuserupdate">panuserupdate</a> in the Searchbar Command documentation.</p>
<h2 id="more-information-distribute-user-id">More Information: Distribute User-ID</h2>
<p>To simplify administration, you can configure one firewall to be the redistribution firewall that collects all the mapping information and shares it with other firewalls. You configure the receiving firewalls to retrieve the mapping information from the redistribution firewall.</p>
<p><img src="assets/userid_distribution.png" alt=""></p>
<p><strong>Configure a Firewall to Share User Mapping Data with Other Firewalls</strong> <a href="https://www.paloaltonetworks.com/documentation/70/pan-os/pan-os/user-id/configure-a-firewall-to-share-user-mapping-data-with-other-firewalls.html" target="_blank">https://www.paloaltonetworks.com/documentation/70/pan-os/pan-os/user-id/configure-a-firewall-to-share-user-mapping-data-with-other-firewalls.html</a></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class="search-results-count"></span> results matching &quot;<span class="search-query"></span>&quot;</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching &quot;<span class="search-query"></span>&quot;</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="external-search.html" class="navigation navigation-prev " aria-label="Previous page: External Search">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="commands.html" class="navigation navigation-next " aria-label="Next page: Searchbar Command Reference">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"User-ID with Splunk","level":"4.4","depth":1,"next":{"title":"Searchbar Command Reference","level":"4.5","depth":1,"path":"commands.md","ref":"commands.md","articles":[]},"previous":{"title":"External Search","level":"4.3","depth":1,"path":"external-search.md","ref":"external-search.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{"_pictures":[{"backlink":"installation.html#fig2.2.1","level":"2.2","list_caption":"Figure: Downloading the App and Add-on from within Splunk Enterprise.","alt":"Downloading the App and Add-on from within Splunk Enterprise.","nro":1,"url":"assets/download_app.png","index":1,"caption_template":"Figure: _CAPTION_","label":"Downloading the App and Add-on from within Splunk Enterprise.","attributes":{},"skip":false,"key":"2.2.1"},{"backlink":"getting-data-in.html#fig2.3.1","level":"2.3","list_caption":"Figure: Architecture Diagram","alt":"Architecture Diagram","nro":2,"url":"/assets/architecture.png","index":1,"caption_template":"Figure: _CAPTION_","label":"Architecture Diagram","attributes":{},"skip":false,"key":"2.3.1"},{"backlink":"firewalls-panorama-and-traps.html#fig2.3.1.1","level":"2.3.1","list_caption":"Figure: The credentials name \"Firewall\" will be used for connection to Firewalls or Panorama","alt":"","nro":3,"url":"https://splunk.paloaltonetworks.com/assets/firewall-credentials.png","index":1,"caption_template":"Figure: _CAPTION_","label":"The credentials name \"Firewall\" will be used for connection to Firewalls or Panorama","attributes":{},"title":"The credentials name \"Firewall\" will be used for connection to Firewalls or Panorama","skip":false,"key":"2.3.1.1"},{"backlink":"autofocus-and-minemeld.html#fig2.3.4.1","level":"2.3.4","list_caption":"Figure: Example of MineMeld nodes (Left to Right: miners, processors, outputs","alt":"Example of MineMeld nodes (Left to Right: miners, processors, outputs","nro":4,"url":"/assets/minemeld-nodes.png","index":1,"caption_template":"Figure: _CAPTION_","label":"Example of MineMeld nodes (Left to Right: miners, processors, outputs","attributes":{},"skip":false,"key":"2.3.4.1"},{"backlink":"autofocus-and-minemeld.html#fig2.3.4.2","level":"2.3.4","list_caption":"Figure: MineMeld Feed URL needed for Splunk","alt":"MineMeld Feed URL needed for Splunk","nro":5,"url":"/assets/minemeld-feed-url.png","index":2,"caption_template":"Figure: _CAPTION_","label":"MineMeld Feed URL needed for Splunk","attributes":{},"skip":false,"key":"2.3.4.2"},{"backlink":"autofocus-and-minemeld.html#fig2.3.4.3","level":"2.3.4","list_caption":"Figure: Enter an AutoFocus API Key to collect information about AutoFocus tags in MineMeld data","alt":"Enter an AutoFocus API Key to collect information about AutoFocus tags in MineMeld data","nro":6,"url":"/assets/autofocus-api-key.png","index":3,"caption_template":"Figure: _CAPTION_","label":"Enter an AutoFocus API Key to collect information about AutoFocus tags in MineMeld data","attributes":{},"skip":false,"key":"2.3.4.3"},{"backlink":"wildfire.html#fig2.3.6.1","level":"2.3.6","list_caption":"Figure: WildFire dashboard with data","alt":"WildFire dashboard with data","nro":7,"url":"/assets/wildfire_dashboard.png","index":1,"caption_template":"Figure: _CAPTION_","label":"WildFire dashboard with data","attributes":{},"skip":false,"key":"2.3.6.1"},{"backlink":"upgrade.html#fig3.1.1","level":"3.1","list_caption":"Figure: The credentials name \"Firewall\" will be used for connection to Firewalls or Panorama","alt":"The credentials name \"Firewall\" will be used for connection to Firewalls or Panorama","nro":8,"url":"/assets/firewall-credentials.png","index":1,"caption_template":"Figure: _CAPTION_","label":"The credentials name \"Firewall\" will be used for connection to Firewalls or Panorama","attributes":{},"skip":false,"key":"3.1.1"},{"backlink":"adaptive-response.html#fig4.1.1","level":"4.1","list_caption":"Figure: The credentials name \"Firewall\" will be used for connection to Firewalls or Panorama","alt":"The credentials name \"Firewall\" will be used for connection to Firewalls or Panorama","nro":9,"url":"/assets/firewall-credentials.png","index":1,"caption_template":"Figure: _CAPTION_","label":"The credentials name \"Firewall\" will be used for connection to Firewalls or Panorama","attributes":{},"skip":false,"key":"4.1.1"},{"backlink":"adaptive-response.html#fig4.1.2","level":"4.1","list_caption":"Figure: Firewall permissions required for App special features","alt":"Firewall permissions required for App special features","nro":10,"url":"/assets/admin_role.png","index":2,"caption_template":"Figure: _CAPTION_","label":"Firewall permissions required for App special features","attributes":{},"skip":false,"key":"4.1.2"}]},"plugins":["image-captions","bootstrap-callout","header","collapsible-chapters","ga"],"pluginsConfig":{"scripts":{"files":[]},"search":{},"collapsible-chapters":{},"layout":{"headerPath":"layouts/header.html"},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"header":{},"bootstrap-callout":{},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"ga":{"configuration":{"cookieDomain":"splunk.paloaltonetworks.com"},"token":"UA-44897305-6"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"image-captions":{"variable_name":"_pictures"}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"userid.md","mtime":"2021-04-13T19:28:14.732Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-04-13T19:28:47.671Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-collapsible-chapters/collapsible-chapters.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js"></script>
    <script src="js/anchorsettings.js"></script>

    </body>
</html>

