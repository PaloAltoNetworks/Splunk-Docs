
<!DOCTYPE HTML>
<html lang="">
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Add Context to Searches &#xB7; GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-image-captions/image-captions.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-bootstrap-callout/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-collapsible-chapters/collapsible-chapters.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

        
    
    
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="adaptive-response.html">
    
    
    <link rel="prev" href="enterprise-security.html">
    

    </head>
    <body>
        
<div class="book"><nav class="navbar navbar-default hidden-xs hidden-sm">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand" href=".">
                Palo Alto Networks App for Splunk
            </a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-menu">
            <ul class="nav navbar-nav navbar-left" style="margin-left: 30px;">
                <li><a href="https://splunkbase.splunk.com/app/491">Download App</a></li>
                <li><a href="https://splunkbase.splunk.com/app/2757/">Download Add-on</a></li>
                <li><a href="/faq.html">FAQ</a></li>
                <li><a href="https://www.paloaltonetworks.com/partners/strategic-partners/splunk">Splunk Partnership</a></li>
            </ul>
        </div>
    </div>
</nav>
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search">
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">Overview</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="webinars-and-videos.html">
            
                <a href="webinars-and-videos.html">
            
                    
                    Webinars and Videos
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="faq.html">
            
                <a href="faq.html">
            
                    
                    Frequently Asked Questions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="troubleshoot.html">
            
                <a href="troubleshoot.html">
            
                    
                    Troubleshooting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="support.html">
            
                <a href="support.html">
            
                    
                    Get Support
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="release-notes.html">
            
                <a href="release-notes.html">
            
                    
                    Release Notes
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Getting Started</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="installation.html">
            
                <a href="installation.html">
            
                    
                    Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="getting-data-in.html">
            
                <a href="getting-data-in.html">
            
                    
                    Getting Data Into Splunk
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="firewalls-panorama.html">
            
                <a href="firewalls-panorama.html">
            
                    
                    Firewalls and Panorama
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.2" data-path="cortex-xdr.html">
            
                <a href="cortex-xdr.html">
            
                    
                    Cortex XDR
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.3" data-path="cortex-hec.html">
            
                <a href="cortex-hec.html">
            
                    
                    Cortex Data Lake
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.4" data-path="aperture.html">
            
                <a href="aperture.html">
            
                    
                    Aperture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.5" data-path="autofocus-and-minemeld.html">
            
                <a href="autofocus-and-minemeld.html">
            
                    
                    AutoFocus and MineMeld
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.6" data-path="iot-security.html">
            
                <a href="iot-security.html">
            
                    
                    IoT Security
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.7" data-path="universal-forwarder.html">
            
                <a href="universal-forwarder.html">
            
                    
                    Syslog-ng and Universal Forwarder
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="log-correlation.html">
            
                <a href="log-correlation.html">
            
                    
                    Log Correlation
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Configuration</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="tune-or-reduce-firewall-logs.html">
            
                <a href="tune-or-reduce-firewall-logs.html">
            
                    
                    Tune or Reduce Firewall Logs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="enterprise-security.html">
            
                <a href="enterprise-security.html">
            
                    
                    Splunk Enterprise Security
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="3.3" data-path="lookups.html">
            
                <a href="lookups.html">
            
                    
                    Add Context to Searches
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Advanced Features</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="adaptive-response.html">
            
                <a href="adaptive-response.html">
            
                    
                    Adaptive Response
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="threat-intelligence.html">
            
                <a href="threat-intelligence.html">
            
                    
                    Threat Intelligence
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="external-search.html">
            
                <a href="external-search.html">
            
                    
                    External Search
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="userid.html">
            
                <a href="userid.html">
            
                    
                    User-ID with Splunk
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="commands.html">
            
                <a href="commands.html">
            
                    
                    Searchbar Command Reference
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".">Add Context to Searches</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="add-context-to-splunk-searches">Add Context to Splunk Searches</h1>
<h2 id="subnet-and-ip-classification">Subnet and IP Classification</h2>
<p>Classify IP addresses in Splunk by any criteria relevant to your environment. IP ranges can be designated as DMZ, datacenter, VMware, serverfarm, webtier, or any other relevant keyword to help distinguish and classify a group of IP addresses during a search.</p>
<p>Classifications will show up in the <code>src_class</code> and <code>dest_class</code> fields.</p>
<p>Classifications are set in the lookup file <code>ip_classifictions.csv</code>. Add subnets and their classification to the <code>ip_classifications.csv</code> file, one per line.</p>
<p>For example:</p>
<pre><code>cidr,classification
10.0.0.0/8,private
172.16.0.0/12,private
192.168.0.0/16,private
10.5.5.0/24,dmz
10.240.0.0/16,datacenter1
192.168.5.0/24,partner-mpls
</code></pre><p>More specific entries take precedence.</p>
<p>Now look for the classifications in the <code>src_class</code> and <code>dest_class</code> fields during a search that includes these IP address ranges.</p>
<h2 id="saas">Sanctioned and Unsanctioned SaaS Detection </h2>
<p><em>Added in App version 5.0</em></p>
<p>Classify SaaS applications as sanctioned or unsanctioned for your organization. This designation is used in searches using the Splunk searchbar and to separate information in the App&apos;s SaaS Dashboard.</p>
<p>SaaS applications are designated as sanctioned in the lookup file <code>sanctioned_saas.csv</code> in the Splunk_TA_paloalto Add-on.</p>
<p>Add each sanctioned SaaS app in the lookup file, one per line. For example:</p>
<pre><code>app,sanctioned_saas
paloalto-wildfire-cloud,yes
boxnet,yes
dropbox,yes
gmail-enterprise,yes
skype,yes
facebook-base,yes
gmail-chat,yes
</code></pre><p>Sanctioned designation is found in the field <code>app:is_sanctioned_saas</code>.</p>
<p>For a list of all SaaS applications, visit <a href="https://applipedia.paloaltonetworks.com/" target="_blank">Applipedia</a> and under the Characteristics header, click SaaS.</p>
<h2 id="contentpack">Update App and Threat Metadata from Content Pack </h2>
<p><em>Added in App version 5.0</em></p>
<p>The Palo Alto Networks Add-on (TA) comes with two lookup files with metadata about applications and threat signatures called <code>app_list.csv</code> and <code>threat_list.csv</code>, respectively. These lookup tables are responsible for populating the app:xyz and threat:xyz fields used in the dashboards and displayed during a search.</p>
<p>The lookup table files are updated with major Add-on releases, but can get out of date between releases. To keep the files up to date, they can be updated dynamically from the content pack metadata in your firewall or Panorama. This is done by creating a saved search inside the Add-on to periodically pull the metadata from the firewall or Panorama and update the lookup tables.</p>
<p>Create the following saved searches in the TA, by creating the file: <code>$SPLUNK_HOME/etc/apps/Splunk_TA_paloalto/local/savedsearches.conf</code> :</p>
<pre><code>[Palo Alto Networks - Retrieve ContentPack Apps]
cron_schedule = 5 0 * * 6
dispatch.earliest_time = -1m@m
displayview = flashtimeline
enableSched = 1
realtime_schedule = 0
request.ui_dispatch_view = flashtimeline
search = | pancontentpack &lt;IP-or-hostname&gt; apps | outputlookup createinapp=true app_lookup
disabled = 0

[Palo Alto Networks - Retrieve ContentPack Threats]
cron_schedule = 10 0 * * 6
dispatch.earliest_time = -1m@m
displayview = flashtimeline
enableSched = 1
realtime_schedule = 0
request.ui_dispatch_view = flashtimeline
search = | pancontentpack &lt;IP-or-hostname&gt; threats | outputlookup createinapp=true threat_lookup
disabled = 0
</code></pre><p>Set <code>&lt;IP-or-hostname&gt;</code> to the IP or hostname of your Firewall or Panorama. Ensure you set the credentials for this device in the Add-on configuration. See <a href="adaptive-response.html#configure-adaptive-response">Configure Adaptive Response</a> for more information.</p>
<p>This example updates the lookup tables every Saturday at 12:05 AM for apps and 12:10 AM for threats. Change the cron_schedule to your desired update schedule.</p>
<div class="callout callout-primary"><h4 id="note">Note</h4><div><p>The Palo Alto Networks App version 5.0 or higher must be installed for the lookup table update to work. But the saved searches must be created in the Add-on, not the App.</p><p>If using a custom admin role on the firewall, it must have <strong>Configuration</strong> permissions for the <strong>XML API</strong>. See <a href="adaptive-response.html#configure-adaptive-response">Configure Adaptive Response</a> for more information.</p></div></div>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class="search-results-count"></span> results matching &quot;<span class="search-query"></span>&quot;</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching &quot;<span class="search-query"></span>&quot;</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="enterprise-security.html" class="navigation navigation-prev " aria-label="Previous page: Splunk Enterprise Security">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="adaptive-response.html" class="navigation navigation-next " aria-label="Next page: Adaptive Response">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Add Context to Searches","level":"3.3","depth":1,"next":{"title":"Adaptive Response","level":"4.1","depth":1,"path":"adaptive-response.md","ref":"adaptive-response.md","articles":[]},"previous":{"title":"Splunk Enterprise Security","level":"3.2","depth":1,"path":"enterprise-security.md","ref":"enterprise-security.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{"_pictures":[{"backlink":"troubleshoot.html#fig1.4.1","level":"1.4","list_caption":"Figure: screenshot","alt":"screenshot","nro":1,"url":"/assets/add-on.jpg","index":1,"caption_template":"Figure: _CAPTION_","label":"screenshot","attributes":{},"skip":false,"key":"1.4.1"},{"backlink":"troubleshoot.html#fig1.4.2","level":"1.4","list_caption":"Figure: screenshot","alt":"screenshot","nro":2,"url":"/assets/enable-debug-logs.jpg","index":2,"caption_template":"Figure: _CAPTION_","label":"screenshot","attributes":{},"skip":false,"key":"1.4.2"},{"backlink":"troubleshoot.html#fig1.4.3","level":"1.4","list_caption":"Figure: screenshot","alt":"screenshot","nro":3,"url":"/assets/cortex-xdr-debug.jpg","index":3,"caption_template":"Figure: _CAPTION_","label":"screenshot","attributes":{},"skip":false,"key":"1.4.3"},{"backlink":"installation.html#fig2.1.1","level":"2.1","list_caption":"Figure: Downloading the App and Add-on from within Splunk Enterprise.","alt":"Downloading the App and Add-on from within Splunk Enterprise.","nro":4,"url":"assets/download_app.png","index":1,"caption_template":"Figure: _CAPTION_","label":"Downloading the App and Add-on from within Splunk Enterprise.","attributes":{},"skip":false,"key":"2.1.1"},{"backlink":"firewalls-panorama.html#fig2.2.1.1","level":"2.2.1","list_caption":"Figure: The credentials name \"Firewall\" will be used for connection to Firewalls or Panorama","alt":"","nro":5,"url":"https://splunk.paloaltonetworks.com/assets/firewall-credentials.png","index":1,"caption_template":"Figure: _CAPTION_","label":"The credentials name \"Firewall\" will be used for connection to Firewalls or Panorama","attributes":{},"title":"The credentials name \"Firewall\" will be used for connection to Firewalls or Panorama","skip":false,"key":"2.2.1.1"},{"backlink":"cortex-xdr.html#fig2.2.2.1","level":"2.2.2","list_caption":"Figure: screenshot","alt":"screenshot","nro":6,"url":"/assets/add-on.jpg","index":1,"caption_template":"Figure: _CAPTION_","label":"screenshot","attributes":{},"skip":false,"key":"2.2.2.1"},{"backlink":"cortex-xdr.html#fig2.2.2.2","level":"2.2.2","list_caption":"Figure: screenshot","alt":"screenshot","nro":7,"url":"/assets/cortex-xdr-mod-input.jpg","index":2,"caption_template":"Figure: _CAPTION_","label":"screenshot","attributes":{},"skip":false,"key":"2.2.2.2"},{"backlink":"autofocus-and-minemeld.html#fig2.2.5.1","level":"2.2.5","list_caption":"Figure: Example of MineMeld nodes (Left to Right: miners, processors, outputs","alt":"Example of MineMeld nodes (Left to Right: miners, processors, outputs","nro":8,"url":"/assets/minemeld-nodes.png","index":1,"caption_template":"Figure: _CAPTION_","label":"Example of MineMeld nodes (Left to Right: miners, processors, outputs","attributes":{},"skip":false,"key":"2.2.5.1"},{"backlink":"autofocus-and-minemeld.html#fig2.2.5.2","level":"2.2.5","list_caption":"Figure: MineMeld Feed URL needed for Splunk","alt":"MineMeld Feed URL needed for Splunk","nro":9,"url":"/assets/minemeld-feed-url.png","index":2,"caption_template":"Figure: _CAPTION_","label":"MineMeld Feed URL needed for Splunk","attributes":{},"skip":false,"key":"2.2.5.2"},{"backlink":"autofocus-and-minemeld.html#fig2.2.5.3","level":"2.2.5","list_caption":"Figure: Enter an AutoFocus API Key to collect information about AutoFocus tags in MineMeld data","alt":"Enter an AutoFocus API Key to collect information about AutoFocus tags in MineMeld data","nro":10,"url":"/assets/autofocus-api-key.png","index":3,"caption_template":"Figure: _CAPTION_","label":"Enter an AutoFocus API Key to collect information about AutoFocus tags in MineMeld data","attributes":{},"skip":false,"key":"2.2.5.3"},{"backlink":"adaptive-response.html#fig4.1.1","level":"4.1","list_caption":"Figure: The credentials name \"Firewall\" will be used for connection to Firewalls or Panorama","alt":"The credentials name \"Firewall\" will be used for connection to Firewalls or Panorama","nro":11,"url":"/assets/firewall-credentials.png","index":1,"caption_template":"Figure: _CAPTION_","label":"The credentials name \"Firewall\" will be used for connection to Firewalls or Panorama","attributes":{},"skip":false,"key":"4.1.1"},{"backlink":"adaptive-response.html#fig4.1.2","level":"4.1","list_caption":"Figure: Firewall permissions required for App special features","alt":"Firewall permissions required for App special features","nro":12,"url":"/assets/admin_role.png","index":2,"caption_template":"Figure: _CAPTION_","label":"Firewall permissions required for App special features","attributes":{},"skip":false,"key":"4.1.2"}]},"plugins":["image-captions","bootstrap-callout","header","collapsible-chapters","ga"],"pluginsConfig":{"scripts":{"files":[]},"search":{},"collapsible-chapters":{},"layout":{"headerPath":"layouts/header.html"},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"header":{},"bootstrap-callout":{},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"ga":{"configuration":{"cookieDomain":"splunk.paloaltonetworks.com"},"token":"UA-44897305-6"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"image-captions":{"variable_name":"_pictures"}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"lookups.md","mtime":"2021-06-02T17:02:30.621Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-06-02T17:03:00.660Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-collapsible-chapters/collapsible-chapters.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js"></script>
    <script src="js/anchorsettings.js"></script>

    </body>
</html>

