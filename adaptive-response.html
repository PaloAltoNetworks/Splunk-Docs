
<!DOCTYPE HTML>
<html lang="">
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Adaptive Response &#xB7; GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-image-captions/image-captions.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-bootstrap-callout/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-collapsible-chapters/collapsible-chapters.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

        
    
    
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="threat-intelligence.html">
    
    
    <link rel="prev" href="lookups.html">
    

    </head>
    <body>
        
<div class="book"><nav class="navbar navbar-default hidden-xs hidden-sm">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand" href=".">
                Palo Alto Networks App for Splunk
            </a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-menu">
            <ul class="nav navbar-nav navbar-left" style="margin-left: 30px;">
                <li><a href="https://splunkbase.splunk.com/app/491">Download App</a></li>
                <li><a href="https://splunkbase.splunk.com/app/2757/">Download Add-on</a></li>
                <li><a href="/faq.html">FAQ</a></li>
                <li><a href="https://www.paloaltonetworks.com/partners/strategic-partners/splunk">Splunk Partnership</a></li>
            </ul>
        </div>
    </div>
</nav>
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search">
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">Overview</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="webinars-and-videos.html">
            
                <a href="webinars-and-videos.html">
            
                    
                    Webinars and Videos
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="faq.html">
            
                <a href="faq.html">
            
                    
                    Frequently Asked Questions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="troubleshoot.html">
            
                <a href="troubleshoot.html">
            
                    
                    Troubleshooting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="support.html">
            
                <a href="support.html">
            
                    
                    Get Support
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="release-notes.html">
            
                <a href="release-notes.html">
            
                    
                    Release Notes
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Getting Started</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="compatibility.html">
            
                <a href="compatibility.html">
            
                    
                    Compatibility
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="installation.html">
            
                <a href="installation.html">
            
                    
                    Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="getting-data-in.html">
            
                <a href="getting-data-in.html">
            
                    
                    Getting Data Into Splunk
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.3.1" data-path="firewalls-panorama-and-traps.html">
            
                <a href="firewalls-panorama-and-traps.html">
            
                    
                    Firewalls, Panorama, and Traps
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.2" data-path="aperture.html">
            
                <a href="aperture.html">
            
                    
                    Aperture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.3" data-path="autofocus-and-minemeld.html">
            
                <a href="autofocus-and-minemeld.html">
            
                    
                    AutoFocus and MineMeld
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.4" data-path="wildfire.html">
            
                <a href="wildfire.html">
            
                    
                    WildFire
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.5" data-path="universal-forwarder.html">
            
                <a href="universal-forwarder.html">
            
                    
                    Syslog-ng and Universal Forwarder
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="log-correlation.html">
            
                <a href="log-correlation.html">
            
                    
                    Log Correlation
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Configuration</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="upgrade.html">
            
                <a href="upgrade.html">
            
                    
                    Upgrade the App/Add-on
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="tune-or-reduce-firewall-logs.html">
            
                <a href="tune-or-reduce-firewall-logs.html">
            
                    
                    Tune or Reduce Firewall Logs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="enterprise-security.html">
            
                <a href="enterprise-security.html">
            
                    
                    Splunk Enterprise Security
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="lookups.html">
            
                <a href="lookups.html">
            
                    
                    Add Context to Searches
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Advanced Features</li>
        
        
    
        <li class="chapter active" data-level="4.1" data-path="adaptive-response.html">
            
                <a href="adaptive-response.html">
            
                    
                    Adaptive Response
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="threat-intelligence.html">
            
                <a href="threat-intelligence.html">
            
                    
                    Threat Intelligence
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="external-search.html">
            
                <a href="external-search.html">
            
                    
                    External Search
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="userid.html">
            
                <a href="userid.html">
            
                    
                    User-ID with Splunk
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="commands.html">
            
                <a href="commands.html">
            
                    
                    Searchbar Command Reference
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="dashboards.html">
            
                <a href="dashboards.html">
            
                    
                    Dashboard Reference
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".">Adaptive Response</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="set-up-adaptive-response">Set Up Adaptive Response</h1>
<h2 id="automated-remediation">Automated Remediation</h2>
<p>Use the <a href="commands.html#pantag">pantag</a> command to share context from Splunk to the firewall for automated remediation.</p>
<p>This webinar explains the concept of automated remediation and demonstrates a case study of a real customer using this technique with Splunk and Palo Alto Networks today:</p>
<p>Webinar: <a href="https://www.paloaltonetworks.com/resources/webcasts/defeat-apts-improve-security-posture-real-time.html" target="_blank">Defeat APT with Automated Remediation in Splunk</a></p>
<h2 id="share-context-with-dynamic-address-groups">Share context with Dynamic Address Groups</h2>
<p>Tagging an IP address means setting metadata or context on the firewall for that IP, which causes it to be added to corresponding Dynamic Address Groups in the firewall security policy. For example, you could create a rule in the security policy that blocks any IP address with the tag &apos;bad-actor&apos;. Initially, no IP addresses would be blocked, but you can create a search in Splunk for criteria that represents a problem device, and trigger a tagging of that IP address with the &apos;bad-actor&apos; tag. The firewall would add the IP address to the Dynamic Address Group in the policy automatically and begin blocking the IP.</p>
<p>Blocking a bad actor is just the beginning, and you aren&apos;t limited to allow or deny as your options. You could tag an IP address for additional scrutiny by the Threat Prevention engine, or as a known trusted server to be given additional permissions. The behaviors are defined by your security policy, and how you treat IP addresses with specific tags.</p>
<p><strong>See also:</strong></p>
<blockquote>
<p>Command reference: <a href="commands.html#pantag">pantag</a></p>
</blockquote>
<p>Webinar that explains the concept of automated remediation and demonstrates a case study of a real customer using this technique with Splunk and Palo Alto Networks today:</p>
<blockquote>
<p>Webinar: <a href="https://www.paloaltonetworks.com/resources/webcasts/defeat-apts-improve-security-posture-real-time.html" target="_blank">Defeat APT with Automated Remediation in Splunk</a></p>
</blockquote>
<p>Video from a session at Ignite 2015 explains Dynamic Address Groups in more detail with several use cases including asset management:</p>
<blockquote>
<p>Video: <a href="https://www.youtube.com/watch?v=Kv0SR9KLDj4" target="_blank">Applying Order to Computing Chaos</a></p>
</blockquote>
<h2 id="configure-adaptive-response">Configure Adaptive Response</h2>
<p>To use Adaptive Response or the custom searchbar commands, please configure the Add-on with credentials for your Firewall or Panorama.</p>
<p>To configure credentials, navigate to the Add-on, click the <strong>Palo Alto Networks</strong> menu in the top left of the App, and click <strong>Configuration</strong>.</p>
<div class="callout callout-primary"><h4 id="note">Note</h4><div><p>To configure Add-on 3.x, navigate to the Splunk App Manager. Find the Add-on (Palo Alto Networks Add-on for Splunk) in the list and on the right side click <strong>Set up</strong>.</p></div></div>
<figure id="fig4.1.1"><img src="assets/firewall-credentials.png" alt="The credentials name &quot;Firewall&quot; will be used for connection to Firewalls or Panorama"><figcaption>Figure: The credentials name &quot;Firewall&quot; will be used for connection to Firewalls or Panorama</figcaption></figure>
<p>Enter the credentials for your Firewall or Panorama and name the credentials &quot;Firewall&quot;. Only one set of credentials can be entered with this name. The credentials are encrypted by Splunk and used for the following features:</p>
<ul>
<li><a href="userid.html">Sync user login events with User-ID</a></li>
<li><a href="adaptive-response.html">Share context with Dynamic Address Groups</a></li>
<li><a href="lookups.html#contentpack">Update metadata from content packs</a></li>
</ul>
<h4 id="optional-create-a-splunk-user-on-firewallpanorama">Optional: Create a Splunk User on Firewall/Panorama</h4>
<p>Optionally, you can create a user for Splunk on the firewall or Panorama, and reduce the user&apos;s role to just what is required. The permissions needed depend on which features will be used.</p>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Permission Needed</th>
</tr>
</thead>
<tbody>
<tr>
<td>Commands: <a href="commands.html#pantag">pantag</a>, <a href="commands.html#panuserupdate">panuserupdate</a></td>
<td>User-ID Agent</td>
</tr>
<tr>
<td>Alert Action - Tag to Dynamic Address List</td>
<td>User-ID Agent</td>
</tr>
<tr>
<td>Command: <a href="commands.html#pancontentpack">pancontentpack</a> with PAN-OS &lt; 8.0</td>
<td>Configuration</td>
</tr>
<tr>
<td>Command: <a href="commands.html#pancontentpack">pancontentpack</a> with PAN-OS &gt;= 8.0</td>
<td>Configuration and Operational Requests</td>
</tr>
</tbody>
</table>
<figure id="fig4.1.2"><img src="assets/admin_role.png" alt="Firewall permissions required for App special features"><figcaption>Figure: Firewall permissions required for App special features</figcaption></figure>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class="search-results-count"></span> results matching &quot;<span class="search-query"></span>&quot;</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching &quot;<span class="search-query"></span>&quot;</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="lookups.html" class="navigation navigation-prev " aria-label="Previous page: Add Context to Searches">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="threat-intelligence.html" class="navigation navigation-next " aria-label="Next page: Threat Intelligence">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Adaptive Response","level":"4.1","depth":1,"next":{"title":"Threat Intelligence","level":"4.2","depth":1,"path":"threat-intelligence.md","ref":"threat-intelligence.md","articles":[]},"previous":{"title":"Add Context to Searches","level":"3.4","depth":1,"path":"lookups.md","ref":"lookups.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{"_pictures":[{"backlink":"installation.html#fig2.2.1","level":"2.2","list_caption":"Figure: Downloading the App and Add-on from within Splunk Enterprise.","alt":"Downloading the App and Add-on from within Splunk Enterprise.","nro":1,"url":"assets/download_app.png","index":1,"caption_template":"Figure: _CAPTION_","label":"Downloading the App and Add-on from within Splunk Enterprise.","attributes":{},"skip":false,"key":"2.2.1"},{"backlink":"getting-data-in.html#fig2.3.1","level":"2.3","list_caption":"Figure: Architecture Diagram","alt":"Architecture Diagram","nro":2,"url":"/assets/architecture.png","index":1,"caption_template":"Figure: _CAPTION_","label":"Architecture Diagram","attributes":{},"skip":false,"key":"2.3.1"},{"backlink":"firewalls-panorama-and-traps.html#fig2.3.1.1","level":"2.3.1","list_caption":"Figure: The credentials name \"Firewall\" will be used for connection to Firewalls or Panorama","alt":"","nro":3,"url":"https://splunk.paloaltonetworks.com/assets/firewall-credentials.png","index":1,"caption_template":"Figure: _CAPTION_","label":"The credentials name \"Firewall\" will be used for connection to Firewalls or Panorama","attributes":{},"title":"The credentials name \"Firewall\" will be used for connection to Firewalls or Panorama","skip":false,"key":"2.3.1.1"},{"backlink":"autofocus-and-minemeld.html#fig2.3.3.1","level":"2.3.3","list_caption":"Figure: Example of MineMeld nodes (Left to Right: miners, processors, outputs","alt":"Example of MineMeld nodes (Left to Right: miners, processors, outputs","nro":4,"url":"/assets/minemeld-nodes.png","index":1,"caption_template":"Figure: _CAPTION_","label":"Example of MineMeld nodes (Left to Right: miners, processors, outputs","attributes":{},"skip":false,"key":"2.3.3.1"},{"backlink":"autofocus-and-minemeld.html#fig2.3.3.2","level":"2.3.3","list_caption":"Figure: MineMeld Feed URL needed for Splunk","alt":"MineMeld Feed URL needed for Splunk","nro":5,"url":"/assets/minemeld-feed-url.png","index":2,"caption_template":"Figure: _CAPTION_","label":"MineMeld Feed URL needed for Splunk","attributes":{},"skip":false,"key":"2.3.3.2"},{"backlink":"autofocus-and-minemeld.html#fig2.3.3.3","level":"2.3.3","list_caption":"Figure: Enter an AutoFocus API Key to collect information about AutoFocus tags in MineMeld data","alt":"Enter an AutoFocus API Key to collect information about AutoFocus tags in MineMeld data","nro":6,"url":"/assets/autofocus-api-key.png","index":3,"caption_template":"Figure: _CAPTION_","label":"Enter an AutoFocus API Key to collect information about AutoFocus tags in MineMeld data","attributes":{},"skip":false,"key":"2.3.3.3"},{"backlink":"wildfire.html#fig2.3.4.1","level":"2.3.4","list_caption":"Figure: WildFire dashboard with data","alt":"WildFire dashboard with data","nro":7,"url":"/assets/wildfire_dashboard.png","index":1,"caption_template":"Figure: _CAPTION_","label":"WildFire dashboard with data","attributes":{},"skip":false,"key":"2.3.4.1"},{"backlink":"upgrade.html#fig3.1.1","level":"3.1","list_caption":"Figure: The credentials name \"Firewall\" will be used for connection to Firewalls or Panorama","alt":"The credentials name \"Firewall\" will be used for connection to Firewalls or Panorama","nro":8,"url":"/assets/firewall-credentials.png","index":1,"caption_template":"Figure: _CAPTION_","label":"The credentials name \"Firewall\" will be used for connection to Firewalls or Panorama","attributes":{},"skip":false,"key":"3.1.1"},{"backlink":"adaptive-response.html#fig4.1.1","level":"4.1","list_caption":"Figure: The credentials name \"Firewall\" will be used for connection to Firewalls or Panorama","alt":"The credentials name \"Firewall\" will be used for connection to Firewalls or Panorama","nro":9,"url":"/assets/firewall-credentials.png","index":1,"caption_template":"Figure: _CAPTION_","label":"The credentials name \"Firewall\" will be used for connection to Firewalls or Panorama","attributes":{},"skip":false,"key":"4.1.1"},{"backlink":"adaptive-response.html#fig4.1.2","level":"4.1","list_caption":"Figure: Firewall permissions required for App special features","alt":"Firewall permissions required for App special features","nro":10,"url":"/assets/admin_role.png","index":2,"caption_template":"Figure: _CAPTION_","label":"Firewall permissions required for App special features","attributes":{},"skip":false,"key":"4.1.2"}]},"plugins":["image-captions","bootstrap-callout","header","collapsible-chapters","ga"],"pluginsConfig":{"scripts":{"files":[]},"search":{},"collapsible-chapters":{},"layout":{"headerPath":"layouts/header.html"},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"header":{},"bootstrap-callout":{},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"ga":{"configuration":{"cookieDomain":"splunk.paloaltonetworks.com"},"token":"UA-44897305-6"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"image-captions":{"variable_name":"_pictures"}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"adaptive-response.md","mtime":"2020-04-08T20:16:26.267Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-04-08T20:17:02.543Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-collapsible-chapters/collapsible-chapters.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js"></script>
    <script src="js/anchorsettings.js"></script>

    </body>
</html>

